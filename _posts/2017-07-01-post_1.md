---
layout: post
title: Writing MATLAB code for quasi-infinite horizon nonlinear model predictive control
comments: true
category: blog
---

In this post we will examine how to build a nonlinear model predictive controller (NMPC) with guaranteed stability using MATLAB. The stability property is obtained by construction using the quasi-infinite horizon method proposed in Chen & Allgöwer (1998)[^Chen1998].

$$
\begin{align}
\text{minimize} & \quad \int_{0}^{T}{\norm{e(t)}^2_Q + \norm{u_1(t)}^2_R} ~dt + {\color{blue}  \overbrace{\norm{e(T)}^2_P}^{\text{terminal cost}}}  \\
\text{subject to} & \quad e(0) = \hat{e}(\tau) \\
& \quad \text{for } t \in [0,T]: \\
& \qquad \dot{e}(t) = f(e(t),u_1(t)) \\
& \qquad e_{\text{min}} \leq e(t) \leq e_{\text{max}} \\
& \qquad u_{\text{min}} \leq u_1(t) \leq u_{\text{max}} \\
& \quad {\color{blue}e(T) \in \Omega \text{ (terminal region)}}
\end{align}
$$

[^Chen1998]: Chen, H., & Allgöwer, F. (1998). A Quasi-Infinite Horizon Nonlinear Model Predictive Control Scheme with Guaranteed Stability. Automatica, 34(10), 1205-1217. Available at: [https://engineering.purdue.edu/~zak/ECE680/Chen-Allgower_1998.pdf](https://engineering.purdue.edu/~zak/ECE680/Chen-Allgower_1998.pdf).
